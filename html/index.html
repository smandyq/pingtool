<html>
  <head>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script src="https://cdn.firebase.com/js/client/1.1.2/firebase.js"></script>
    <script type="text/javascript">

    // Load the Visualization API and the piechart package.
    google.load('visualization', '1.0', {'packages':['corechart']});
    google.setOnLoadCallback(setup);
    
    function setup()
    {
    
      //load firebase api
      var myfb = new Firebase("https://pingtool.firebaseio.com");
      
      console.log("loaded");
      
      //call drawChart when firebase gets new data
      myfb.child("pings").on('value', drawChart);
        
      function drawChart(data)
      {
        var ldt = new google.visualization.DataTable();
        var hdt = new google.visualization.DataTable();
        ldt.addColumn('datetime', 'Timestamp');
        ldt.addColumn('number', 'Ping_Time');
        
        hdt.addColumn('string', 'Timestamp');
        hdt.addColumn('number', 'Ping_Time');
        
        //console.log(data.val());
        data.forEach(function(row)
        {
          //console.log(row.val());
          ldt.addRow([new Date(row.val().timestamp), row.val().ping_time])
          hdt.addRow([Date(row.val().timestamp), row.val().ping_time])
        })
        

        var options = {'title':'Ping time vs timestamp',
                       'width':1024,
                       'height':768,
                       'vAxis':{'logScale': true}};
                       
        // Instantiate and draw our chart, passing in some options.
        var lchart = new google.visualization.LineChart(document.getElementById('lchart'));
        var hchart = new google.visualization.Histogram(document.getElementById('hchart'));
        lchart.draw(ldt, options);
        hchart.draw(hdt, options);
                       



      }
    }
    </script>
  </head>
  <body>
    <div id="lchart" style="width: 100%; height: *;" >
    </div>
    <div id="hchart" style="width: 100%; height: *;" >
    </div>
  </body>
</html>
